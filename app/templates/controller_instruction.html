{% extends "base.html" %}


{% block doctype %}
<!doctype html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
{% endblock doctype %}


{% block title %}三维数字铁路网络应用系统-控件下载{% endblock %}


{% block css %}
{{ super() }}
<link rel="stylesheet" href={{ url_for("static", filename="css/index.css") }}>
<style>
  .instruction {
    padding: 0px 50px;
    height: 100%;
    width: 100%;
  }

  .instruction .header {
    margin-bottom: 10px;
  }

  .step {
    margin-bottom: 20px;
  }

  .step p {
    margin: 10px 0;
  }

  .step button {
    margin: 5px;
  }
</style>
{% endblock %}


{% block container %}
<object id="test" classid="clsid:20EFFB03-95B8-407B-AF6E-8F233165B5A8" width="0" height="0">
</object>
<div class="container">
  <div class="left-menu-col noselect">
    <button type="button" class="left-menu-toggle-btn">
      <i class="fa fa-bars" aria-hidden="true"></i>
    </button>
    <div class="left-menu-toggle-wrapper">
      <h1 class="left-menu-head">目录</h1>
      <ul class="left-menu-list">
        <a href="/">
          <li class="left-menu-item menu-inactive">回到主页</li>
        </a>
      </ul>
    </div>
  </div>
  <div class="right-content-col">
    <div class="panel-group">
      <div class="instruction">
        <h1 class="header">安装TerraExplorer软件</h1>
        <div class="step">
          <h2>第一步</h2>
          <p>点击<a href={{ url_for("static", filename="FLYProject/其他资源/TEPlus70.rar") }}
              download="TEPlus70.rar">下载软件安装包</a></p>
        </div>
        <div class="step">
          <h2>第二步</h2>
          <p>根据文本文件"安装提示"进行安装</p>
        </div>
        <h1 class="header">获取局域网访问权限</h1>
        <div class="step">
          <h2>第一步</h2>
          <p>点击<a href={{ url_for("static", filename="FLYProject/其他资源/autoReg.zip") }}
              download="autoReg.zip">下载控件压缩包</a></p>
        </div>
        <div class="step">
          <h2>第二步</h2>
          <p>解压缩, 以管理员身份运行autoregister.bat</p>
          <p>若安装失败, 请以管理员身份运行autoregister1.bat</p>
        </div>
        <div class="step">
          <h2>第三步(需使用IE浏览器)</h2>
          <p>点击此<button class="btn btn-default" onclick="getAccess()">按钮</button>获得局域网访问权限</p>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

{% block js %}
{{ super() }}
<script>
  function getAccess() {
    // 调用控件获取局域网权限
    if (!!window.ActiveXObject || "ActiveXObject" in window) {
      try {
        var mCmd = new ActiveXObject("AxRGUDun.WebLogin");
        mCmd.ConnectToRIMServer();
      } catch (err) {
        alert("连接失败, 请确保控件正确安装。" + err);
      }
    } else {
      alert("请使用IE浏览器操作...");
    }
  }
</script>
{% endblock js%}